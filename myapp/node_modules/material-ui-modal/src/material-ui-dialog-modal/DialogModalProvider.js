import React from 'react';
import { default as DialogModal } from './DialogModal';

const ModalContext = React.createContext();

const DialogModalProvider = (props) => {
    const [option, setOption] = React.useState({
        title: 'Default Title',
        render: () => (<div></div>)
    });
    const [open, setOpen] = React.useState(false);

    const showModal = React.useCallback((option) => {
        if(!option){
            setOpen(false);
        }else{
            setOption(option);
            setOpen(true);
        }
    })

    const handleClose = () => {
        setOpen(false);
        if (option.callback) option.callback(false);
    }

    const handleSubmit = () => {
        setOpen(false);
        if (option.callback) {
            option.callback(true);
        }
    }

    return (
        <React.Fragment>
            <ModalContext.Provider value={showModal}>
                {props.children}
            </ModalContext.Provider>
            <DialogModal maxWidth={option.maxWidth} hideActions={option.hideActions} title={option.title} open={open} onClose={handleClose} onSubmit={handleSubmit} component={() => option.render()} />
        </React.Fragment>
    )
}

const useDialogModal = () => {
    let showModal = React.useContext(ModalContext);
    return showModal;
};

export { DialogModalProvider, useDialogModal };